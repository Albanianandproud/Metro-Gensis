hanza_satellite_immigrant_processing_category = {

	hanza_satellite_immigrant_processing_countdown_until_wave = {
		icon = GFX
		priority = 1001

		activation  = {
			has_idea = hanza_satellite_immigrant_at_the_gates
			hidden_trigger = { has_country_flag = hanza_satellite_immigrant_processing_country_flag }
		}

		available = {
			NOT = {
				has_country_flag = hanza_satellite_immigrant_processing_country_flag
				has_idea = hanza_satellite_immigrant_at_the_gates
			}
		}

		selectable_mission = no
		is_good = yes
		fire_only_once = no

		cancel_trigger = {
			OR = {
				has_idea = civics_border_4
				NOT = { has_country_flag = hanza_satellite_immigrant_processing_country_flag }
			}
		}

		days_mission_timeout = 180

		timeout_effect = {
			custom_effect_tooltip = hanza_satellite_immigrant_countdown_tooltip
			country_event = { id = nf_hanza_satellite.2 }
		}

		ai_will_do = {
			factor = 101
		}
	}

	hanza_satellite_immigrant_processing_increase_regulations = {
		icon = generic_research

		visible = {
			has_active_mission = hanza_satellite_immigrant_processing_countdown_until_wave
		}
		available = {
			hidden_trigger = { has_country_flag = hanza_satellite_immigrant_processing_country_flag }
			has_idea = hanza_satellite_immigrant_at_the_gates
		}
		
		fire_only_once = no

		complete_effect = {
			add_days_mission_timeout = {
			    mission = hanza_satellite_immigrant_processing_countdown_until_wave
			    days = 60
			}
			hidden_effect = {
				random_list = {
					30 = { country_event = { id = nf_hanza_satellite.3 } }
					70 = {  }
				}
			}
		}
		
		days_remove = 3
		days_re_enable = 150
		cost = 50
		ai_will_do = {
			base = 5
		}
	}
	hanza_satellite_immigrant_processing_bar_the_gates = {
		icon = generic_research
		visible = {
			has_active_mission = hanza_satellite_immigrant_processing_countdown_until_wave
		}
		available = { 
			OR = {
				threat > 0.3
				has_stability < 0.4
			}
			hidden_trigger = { has_country_flag = hanza_satellite_immigrant_processing_country_flag }
			has_idea = hanza_satellite_immigrant_at_the_gates
		}
		fire_only_once = yes
		days_remove = 3
		cost = 100
		complete_effect = {
			remove_ideas = hanza_satellite_immigrant_at_the_gates
			hidden_effect = {
				clr_country_flag = hanza_satellite_immigrant_processing_country_flag
			}
		}
		ai_will_do = {
			base = 5
		}
	}
}
hanza_satellite_trade_category = {
	hanza_satellite_bastion_launch_caravan = {
		visible = {
			has_completed_focus = hanza_satellite_24
		}
		available = { 
			has_war = no
			has_manpower > 4 
			has_equipment = { rail_cart_equipment > 0 } 
			FROM = {
				has_war = no
				NOT = {
					is_justifying_wargoal_against = ROOT
					has_wargoal_against = ROOT
				}
			}
		} 
		days_remove = 7
		days_re_enable = 360
		custom_cost_trigger = {
			set_temp_variable = { temp_bullet_cost = 50 }
			check_variable = {
				bullet > temp_bullet_cost
			}
		}
		custom_cost_text = "bullet_decisions_cost_text"
		fire_only_once = no
		complete_effect = {
			hidden_effect = { 
				set_temp_variable = { bullet_to_gain = -50 }
				add_bullet_with_tooltip_effect = yes
			}
		}
		target_array = global.countries
		target_trigger = {
			FROM = { 
				NOT = { 
					has_opinion = {
						target = ROOT
						value < 0
					}
					OR = {
						is_subject = yes
						exists = no
						has_idea = civics_border_4

						original_tag = RUI
						is_major = yes

						has_country_flag = is_mutant_nation
						has_country_flag = is_skaven_nation
						has_country_flag = is_scientist_nation
						has_country_flag = is_savage_nation
						has_country_flag = is_cultist_nation

					}
				}
			}
		}
		complete_effect = {
			FROM = {
				country_event = { 
					id = nf_hanza_satellite_trade.1
					days = 1
					random_days = 1
				}
			}
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				FROM = {
					hanza_satellite_trade_bastion_scripted_effect = yes
				}
				hanza_satellite_improve_relations_scripted_effect = yes
			}
		}
	}
	hanza_satellite_commerce_launch_caravan = {
		visible = {
			has_completed_focus = hanza_satellite_25
		}
		custom_cost_trigger = {
			set_temp_variable = { temp_bullet_cost = 50 }
			check_variable = {
				bullet > temp_bullet_cost
			}
		}
		custom_cost_text = "bullet_decisions_cost_text"
		fire_only_once = no
		complete_effect = {
			hidden_effect = { 
				set_temp_variable = { bullet_to_gain = -50 }
				add_bullet_with_tooltip_effect = yes
			}
		}
		target_array = global.countries
		target_trigger = {
			FROM = { 
				NOT = { 
					has_opinion = {
						target = ROOT
						value < 0
					}
					OR = {
						is_subject = yes
						exists = no
						has_idea = civics_border_4

						original_tag = RUI
						is_major = yes

						has_country_flag = is_mutant_nation
						has_country_flag = is_skaven_nation
						has_country_flag = is_scientist_nation
						has_country_flag = is_savage_nation
						has_country_flag = is_cultist_nation

					}
				}
			}
		}
		complete_effect = {
			FROM = {
				country_event = { 
					id = nf_hanza_satellite_trade.2
					days = 1
					random_days = 1
				}
			}
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				FROM = {
					hanza_satellite_trade_commerce_scripted_effect = yes
				}
				hanza_satellite_improve_relations_scripted_effect = yes
			}
		}
	}
	hanza_satellite_trade_launch_caravan = {
		visible = {
			has_completed_focus = hanza_satellite_25
		}
		custom_cost_trigger = {
			set_temp_variable = { temp_bullet_cost = 50 }
			check_variable = {
				bullet > temp_bullet_cost
			}
		}
		custom_cost_text = "bullet_decisions_cost_text"
		fire_only_once = no
		complete_effect = {
			hidden_effect = { 
				set_temp_variable = { bullet_to_gain = -50 }
				add_bullet_with_tooltip_effect = yes
			}
		}
		target_array = global.countries
		target_trigger = {
			FROM = { 
				NOT = { 
					has_opinion = {
						target = ROOT
						value < 0
					}
					OR = {
						is_subject = yes
						exists = no
						has_idea = civics_border_4

						original_tag = RUI
						is_major = yes

						has_country_flag = is_mutant_nation
						has_country_flag = is_skaven_nation
						has_country_flag = is_scientist_nation
						has_country_flag = is_savage_nation
						has_country_flag = is_cultist_nation

					}
				}
			}
		}
		complete_effect = {
			FROM = {
				country_event = { 
					id = nf_hanza_satellite_trade.3
					days = 1
					random_days = 1
				}
			}
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				FROM = {
					hanza_satellite_trade_trade_scripted_effect = yes
				}
				hanza_satellite_improve_relations_scripted_effect = yes
			}
		}
	}
}